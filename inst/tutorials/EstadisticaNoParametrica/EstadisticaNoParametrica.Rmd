---
title: "M√≥dulo 3: Estad√≠stica no param√©trica en R"
author: "Erika J. Cantor"
date: "Julio, 2025"
output:
  learnr::tutorial:
    progressive: false
    allow_skip: true
    df_print: default
runtime: shiny_prerendered
description: >
  Estad√≠stica no param√©trica tutorial en R.
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
# Attach packages:

library(learnr)
library(fontawesome)
library(ggplot2)
library(tidyverse)
#gradethis::gradethis_setup()
#tutorial_options(exercise.timelimit = 60)

# Global code chunk settings:
knitr::opts_chunk$set(tutorial.exercise.setup = "global")

```



```{r banner, echo=FALSE, results='asis'}
htmltools::HTML("
  <div style='
    text-align: center;
    margin-bottom: 20px;
  '>
    <img src='images/banner_central.png' style='
      max-width: 100%;
      height: auto;
    '>
  </div>
")
```
  
```{r, echo=FALSE, results='asis'}
htmltools::tags$style(HTML("
  h1 {
    color: #1e90ff; /* Azul para t√≠tulos principales */
  }

  h2 {
    color: #007bff; /* Azul brillante para subt√≠tulos */
  }

  h3 {
    color: #0056b3; /* Azul m√°s oscuro para subt√≠tulos m√°s peque√±os */
  }
"))
```


## Introducci√≥n



```{r, echo=FALSE, out.width="100%", fig.align = "center"}
knitr::include_graphics("images/banner.png")  
```


<div class="alert alert-info" role="alert">
Este tutorial interactivo le permitir√° aplicar los conceptos aprendidos sobre  <strong> estad√≠stica no param√©trica </strong> mediante la ejecuci√≥n de c√≥digo en `R`. A trav√©s de ejemplos guiados y ejercicios pr√°cticos, usted desarrollar√° habilidades para implementar pruebas estad√≠sticas no param√©tricas, interpretar sus resultados y tomar decisiones informadas en contextos donde no se cumplen los supuestos de normalidad. 
</div>

### ¬øQu√© aprender√° en esta actividad?

Durante el tutorial, usted aplicar√° los siguientes conceptos:  

- Pruebas de Normalidad.
- Prueba chi-cuadrado. 
- Prueba del signo y prueba de sumas de rangos de wilcoxon. 
- Prueba U de Mann Whitney. 
- Prueba de McNemar. 


<h3>Cr√©ditos</h3>

<p><strong>Autor:</strong> Erika J. Cantor</p>
<p><strong>Afiliaci√≥n:</strong> Departamento de Epidemiolog√≠a Cl√≠nica y Bioestad√≠stica, Facultad de Medicina. Pontificia Universidad Javeriana</p>
<p><strong>Contacto:</strong> <a href="mailto:erika.cantor@javeriana.edu.co">erika.cantor@javeriana.edu.co</a></p>

<p>Este tutorial ha sido desarrollado como parte del curso de <em>Introducci√≥n a la Bioestad√≠stica en la Maestr√≠a en Epidemiolog√≠a Cl√≠nica</em>.</p>



<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Licencia de Creative Commons" style="border-width:0"/></a><br />Esta obra est√° licenciada bajo
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">licencia
de Creative Commons Reconocimiento-NoComercial-CompartirIgual 4.0
Internacional</a>.

##  ¬øC√≥mo desarrollar este tutorial?

A lo largo del tutorial, encontrar√° ejemplos de c√≥digo, ejercicios de programaci√≥n y preguntas de an√°lisis. Los ejemplos de c√≥digo y los ejercicios pretenden introducir habilidades b√°sicas de `R`. No es
necesario tener conocimientos previos sobre R para el desarrollo de este tutorial.

#### `r fa("lightbulb", fill = "orange",  height="2em", width="2em")` = Ejemplo de c√≥digo

Este icono identifica ejemplos de c√≥digo listos para usar. Es posible explorar, ejecutar y modificar este c√≥digo para comprender el funcionamiento de cada funci√≥n o comando. Para ejecutar el c√≥digo, solo es necesario presionar el bot√≥n **Run code** en la esquina superior derecha.


```{r, echo=FALSE, out.width="100%", fig.align = "center"}
knitr::include_graphics("images/ejemplo.png")  
```

> **No es necesario preocuparse por ‚Äúda√±ar‚Äù el c√≥digo:** si se realizan modificaciones que generan errores, el ejemplo original puede restaurarse en cualquier momento mediante el bot√≥n **Start Over** en la esquina superior izquierda.


#### `r fa("pencil-alt", fill = "green", height="2em", width="2em")` = Ejercicio de c√≥digo

Los ejercicios est√°n dise√±ados para aplicar lo aprendido, escribiendo el c√≥digo necesario para resolver las preguntas o problemas planteados.

> **Si siente que se ha quedado sin ideas o no sabe c√≥mo continuar con el ejercicio:** puede consultar el bot√≥n **Solution** (soluci√≥n) o **Hint** (pista) para recibir orientaci√≥n sin perder la oportunidad de aprender activamente.

```{r, echo=FALSE, out.width="100%", fig.align = "center"}
knitr::include_graphics("images/ejercicio.png")  
```

#### `r fa("comments", fill = "#2c5697", height="2em", width="2em")` = Preguntas de an√°lisis

Estas preguntas invitan a reflexionar sobre los resultados y conceptos. Algunas no poseen una √∫nica respuesta correcta, sino que buscan fomentar el pensamiento cr√≠tico. Con frecuencia, estas preguntas est√°n vinculadas con un ejemplo o ejercicio de c√≥digo, y pueden requerir la ejecuci√≥n de dicho c√≥digo para obtener la informaci√≥n necesaria para responderlas.

## Explorando el Nacimiento con Datos


<div style="background-color: #f8f9fa; color: #212529; border: 1px solid #ddd; padding: 15px; border-radius: 5px;">
En este taller, usted trabajar√° con la base de datos `birthwt`, que contiene informaci√≥n sobre el peso al nacer de  189 nacidos vivos en 1986 en el Bay State Medical Center, Springfield. Las variables recolectadas fueron: 
</div>
  
- Bajo Peso (`low`): 0: Peso Normal (>2.5Kg) 1: Bajo peso (<2.5 Kg)

- Edad de la madre en a√±os (`age`).

- Peso de la madre en libras (`lwt`)

- Raza de la madre (`race`): 1: Blanco, 2: Negro, 3: Otra.

- Fumar (`smoke`): 1: Si, 0: No.

- Antecedente de hipertensi√≥n (`ht`):  1: Si, 0: No.

- N√∫mero  de partos prematuros previos (`ptl`).

- Irritaci√≥n uterina (`ui`): 1: Si, 0: No

- N√∫mero de visitas en el primer trimestre (`ftv`).


La base de datos puede ser cargada por medio del siguiente c√≥digo en `R`. Antes de iniciar con el an√°lisis, primero vamos a etiquetar algunas variables categ√≥ricas del conjunto de datos `datos`. En particular, transformaremos las variables `low`, `race`, `smoke`, `ht`y `ui`  en cualitativas con etiquetas m√°s descriptivas que faciliten la interpretaci√≥n.

```{r global, exercise=FALSE}
# Datos
datos <- MASS::birthwt

# Etiquetas
datos$low <- factor(datos$low, labels = c("Normal", "Bajo Peso"))
datos$race <- factor(datos$race, labels = c("Blanco", "Negro", "Otro"))
datos$smoke <- factor(datos$smoke, labels = c("No fuma", "Fuma"))
datos$ht    <- factor(datos$ht, labels = c("No", "S√≠"))
datos$ui    <- factor(datos$ui, labels = c("No", "S√≠"))

head(datos)
```


```{r ver-global, exercise=TRUE, exercise.setup="global", exercise.eval=FALSE}

#Librerias
library(ggplot2)
library(tidyverse)

# Datos
datos <- MASS::birthwt

# Etiquetas
datos$low <- factor(datos$low, labels = c("Normal", "Bajo Peso"))
datos$race <- factor(datos$race, labels = c("Blanco", "Negro", "Otro"))
datos$smoke <- factor(datos$smoke, labels = c("No fuma", "Fuma"))
datos$ht    <- factor(datos$ht, labels = c("No", "S√≠"))
datos$ui    <- factor(datos$ui, labels = c("No", "S√≠"))

head(datos)

```

Ahora que hemos etiquetado las variables, podemos explorar el conjunto de datos para verificar que las etiquetas se hayan aplicado correctamente.


## Pruebas de Normalidad

Evaluar el ajuste a la normalidad es un paso crucial antes de aplicar pruebas estad√≠sticas. En este caso, utilizaremos la prueba de Shapiro-Wilk para evaluar si las variables `age`, `lwt` y `bwt` siguen una distribuci√≥n normal.


En `R`, la funci√≥n `shapiro.test()` permite aplicar la prueba de Shapiro-Wilk para evaluar si una variable sigue una distribuci√≥n normal. De manera complementaria, esta evaluaci√≥n tambi√©n puede realizarse visualmente mediante un gr√°fico Q-Q, utilizando la funci√≥n `qqPlot()`.

Supongamos que nos interesa conocer si la variable `bwt` (peso al nacer) sigue una distribuci√≥n normal, en `R` podemos realizar la prueba de normalidad de la siguiente manera:

```{r norm1, exercise=TRUE,  exercise.setup="global"}
# Prueba de normalidad para la variable 'bwt'
shapiro.test(datos$bwt)

# Gr√°fico Q-Q para la variable 'bwt'
car::qqPlot(datos$bwt, main = "Q-Q Plot de bwt")
```

Con base en los resultados de la prueba de normalidad, podemos concluir  que la variable `bwt` sigue una distribuci√≥n normal, dado que el p valor de 0.435 es mayor al nivel de significancia $\alpha=0.05$ y por lo tanto, no existe suficiente evidencia para rechazar la hip√≥tesis de normalidad. Adem√°s, el gr√°fico Q-Q muestra que los puntos se alinean aproximadamente a lo largo de la l√≠nea diagonal, lo que respalda la conclusi√≥n de normalidad. Ahora, vamos a aplicar la prueba de normalidad a las variables `age` y `lwt` para verificar si tambi√©n siguen una distribuci√≥n normal. 

### üß† Desaf√≠o 1

‚úçÔ∏è Es su turno! Emplee los siguientes chunk (bloque) para escribir el c√≥digo de `R` para las dos variables. Tenga presente que tiene la opci√≥n de ver la soluci√≥n (¬°pero aseg√∫rese de intentar resolverla manualmente primero!). Vamos a iniciar con la variable `age` (edad de la madre).

```{r norm2_ejerc1, exercise=TRUE, exercise.setup="global"}
# Prueba de normalidad para la variable 'age'


# Gr√°fico Q-Q para la variable 'age'

```


```{r norm2_ejerc1-solution}
# Prueba de normalidad para la variable 'age'
shapiro.test(datos$age)

# Gr√°fico Q-Q para la variable 'age'
car::qqPlot(datos$age)
```

Con estos resultados usted puede concluir que (Selecciona la respuesta correcta):

üéØ **Pruebe su conocimiento**

```{r logicals, echo = FALSE}
question(" ¬øQu√© podemos decir sobre la distribuci√≥n de la variable `age`?",
         answer("La variable `age` no sigue una distribuci√≥n normal, existe suficiente evidencia para rechazar  la hip√≥tesis nula de normalidad con la prueba de Shapiro Wilk (p valor<0.05)", correct = TRUE),
         answer("La variable `age`  sigue una distribuci√≥n normal, no existe suficiente evidencia para rechazar  la hip√≥tesis nula de normalidad con la prueba de Shapiro Wilk (p valor<0.05)", message = "Incorrecto, si el p valor es menor al nivel de significancia se rechaza la hip√≥tesis nula de normalidad"),
         allow_retry = TRUE
)
```

### üß† Desaf√≠o 2

‚úçÔ∏è Ahora, vamos a aplicar la prueba de normalidad a la variable `lwt` (peso de la madre) para verificar si tambi√©n sigue una distribuci√≥n normal. **¬øEs normal la variable `lwt` (peso de la madre)?**

```{r norm2_ejerc2, exercise=TRUE, exercise.setup="global"}
# Prueba de normalidad para la variable 'lwt'


# Gr√°fico Q-Q para la variable 'lwt'

```


```{r norm2_ejerc2-solution}
# Prueba de normalidad para la variable 'lwt'
shapiro.test(datos$lwt)

# Gr√°fico Q-Q para la variable 'lwt'
car::qqPlot(datos$lwt)
```

## Pruebas no param√©tricas: Una sola poblaci√≥n

Supongamos que un investigador desea evaluar si la edad promedio de las madres es mayor a 18 a√±os, considerando el contexto del embarazo en adolescentes. Para ello, se plantea como hip√≥tesis nula que la edad promedio es igual a 18 a√±os, y como hip√≥tesis alternativa que es mayor a 18 a√±os. Sin embargo, dado que la variable `age` (edad de la madre) no presenta una distribuci√≥n normal, no es apropiado aplicar la prueba t de Student mediante la funci√≥n `t.test()`. En su lugar, se emplear√° la prueba no param√©trica del signo de Wilcoxon para una muestra, la cual se basa en las medianas, con el fin de contrastar esta hip√≥tesis.

$$H_0: Mediana_{age}=18 \;vs. \; Mediana_{age}<18 $$
En `R`, la funci√≥n `SIGN.test()` del paquete `BSDA` permite realizar la prueba del signo de Wilcoxon. Esta funci√≥n requiere especificar el vector de datos (`datos$age`), la mediana hipot√©tica (`md=18`), el tipo de alternativa (`alternative=greater`) y el nivel de confianza asociado al nivel de significancia ((`conf.level=0.95`).
 

```{r wilcoxon1, exercise=TRUE, exercise.setup="global"}
# Prueba de Wilcoxon para la variable 'age'
BSDA::SIGN.test(datos$age, 
                md = 18, 
                alternative = "greater", 
                conf.level = 0.95)
```

<div style="background-color: #f8f9fa; color: #212529; border: 1px solid #ddd; padding: 15px; border-radius: 5px;">
Dado que el p-valor de la prueba es menor a 2.2e-16 y se utiliza un nivel de significancia de 0.05, existe suficiente evidencia para rechazar la hip√≥tesis nula. Por lo tanto, se concluye que la mediana de la edad de las madres es significativamente mayor a 18 a√±os. Esto sugiere que, la mayor√≠a de las madres tienen m√°s de 18 a√±os.
</div>

### üß† Desaf√≠o 1

Ahora, el investigador desea evaluar si el peso al nacer promedio es mayor a 2500 gramos. Para ello, se plantea como hip√≥tesis nula que el peso al nacer promedio es igual a 2500 gramos, y como hip√≥tesis alternativa que es mayor a 2500 gramos. Con esta informaci√≥n responda la siguiente pregunta:

üéØ **Pruebe su conocimiento**

```{r logicals2, echo = FALSE}
question("¬øCu√°l es la prueba estad√≠stica m√°s adecuada para probar la hipotesis del investigador sobre el peso al nacer `bwt`?",
         answer("Se debe usar la prueba t de Student", correct = TRUE, message = "Correcto, la variable `bwt` sigue una distribuci√≥n normal, por lo tanto se debe usar la prueba t de Student"),
         answer("Se debe usar  la prueba no param√©trica del signo de Wilcoxon" , message = "Incorrecto, lla variable `bwt` sigue una distribuci√≥n normal, por lo tanto se debe usar la prueba t de Student. La prueba del signo solo aplicar√≠a si la variable NO tiene un comportamiento normal"),
         allow_retry = FALSE
)
```


‚úçÔ∏è Es su turno! Emplee el siguiente chunk (bloque) para escribir el c√≥digo de `R` y continuar ayudando al investigador. ¬øExiste evidencia para pensar que el peso promedio al nacer es mayor a 2500 gramos? 

```{r wilcoxon1_ejerc1, exercise=TRUE, exercise.setup="global"}

# Prueba para la variable 'bwt'


```


```{r wilcoxon1_ejerc1-solution}

# Prueba para la variable 'bwt'
t.test(datos$bwt, 
      mu = 2500, 
      alternative = "greater", 
      conf.level = 0.95)
```

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**: Lo invitamos a socializar sus hallazgos en el foro de la semana.
</div>

## Pruebas no param√©tricas: Dos poblaciones

Supongamos que un investigador desea evaluar si la edad promedio de las madres difiere de acuerdo al h√°bito de fumar. Para ello se plantea la hip√≥tesis nula que la edad promedio de las madres que fuman es igual a la de las que no fuman, y como hip√≥tesis alternativa que la edad promedio de las madres que fuman es diferente a la de las que no fuman.

Para decidir qu√© tipo de prueba estad√≠stica utilizar, primero evaluaremos la distribuci√≥n de la variable `age` de acuerdo al h√°bito de fumar `smoke`. Para ello, emplearemos la prueba de normalidad de Shapiro-Wilk.

```{r normality2, exercise=TRUE, exercise.setup="global"}

# Prueba de normalidad para la variable 'age' por grupo de fumar
datos%>% 
  group_by(smoke) %>% 
  summarise(shapiro_p_value = shapiro.test(age)$p.value)
```




Dado que la variable `age` (edad de la madre) no presenta una distribuci√≥n normal (p valor<0.05), no es apropiado aplicar la prueba t de Student mediante la funci√≥n `t.test()`. En su lugar, se emplear√° la prueba U de Mann-Whitney para dos muestras independientes, que se basa en las medianas, con el fin de contrastar esta hip√≥tesis. En este caso, entonces las hip√≥tesis a evaluar son:

$$H_0: Mediana_{age/Fumar}=Mediana_{age/NoFumar} \;vs. \; Mediana_{age/Fumar} \neq Mediana_{age/NoFumar} $$

Antes de realizar la prueba de Mann-Whitney, se podr√≠an calcular las medianas en cada grupo para tener una idea de las diferencias entre los grupos. Esto se puede hacer utilizando la funci√≥n `dplyr::summarise()`.

```{r medianas, exercise=TRUE, exercise.setup="global"}

# Calcular medianas de la variable 'age' por grupo de fumar
datos %>% 
  group_by(smoke) %>% 
  summarise(median_age = median(age, na.rm = TRUE),
            P25=quantile(age, 0.25, na.rm = TRUE),
            P75=quantile(age, 0.75, na.rm = TRUE))

```

En este paso, se observa que la mediana de la edad de las madres es muy similar entre aquellas que no fuman (23 a√±os) y aquellas que fuman (22 a√±os). Sin embargo, para determinar si esta diferencia es estad√≠sticamente significativa, se debe realizar la prueba U de Mann-Whitney.

En `R`, la funci√≥n `wilcox.test()` permite realizar la prueba U de Mann-Whitney. Esta funci√≥n requiere especificar el vector de datos (`age`), el grupo de comparaci√≥n (`smoke`), el tipo de hip√≥tesis alternativa (`alternative="two.sided"`), y el nivel de confianza asociado al nivel de significancia (`conf.level=0.95`).

```{r mannwhitney1, exercise=TRUE, exercise.setup="global"}

# Prueba para comparar medianas en dos poblaciones
wilcox.test(age ~ smoke, 
            data = datos, 
            alternative = "two.sided", 
            conf.level = 0.95)

```


Con la salida anterior, entonces es posible concluir que no existe suficiente evidencia para rechazar la hip√≥tesis nula de que las medianas de la edad de las madres que fuman y las que no fuman son iguales, dado que el p-valor es mayor a 0.05. Por lo tanto, se concluye que no hay una diferencia estad√≠sticamente significativa en la edad promedio de las madres seg√∫n su h√°bito de fumar.

### üß† Desaf√≠o 1

Ahora, el investigador desea evaluar si el peso al nacer promedio difiere de acuerdo al h√°bito de fumar. Para ello, se plantea la hip√≥tesis nula que el peso al nacer promedio de los beb√©s de madres que fuman es igual al de los beb√©s de madres que no fuman, y como hip√≥tesis alternativa que el peso al nacer promedio de los beb√©s de madres que fuman es diferente al de los beb√©s de madres que no fuman. 

Para evaluar esta hip√≥tesis, primero se debe evaluar la distribuci√≥n de la variable `bwt` (peso al nacer) de acuerdo al h√°bito de fumar `smoke`. Para ello, utilice el siguiente chunk (bloque) para escribir el c√≥digo de `R` y continuar ayudando al investigador.

```{r normality2_ejerc1, exercise=TRUE, exercise.setup="global"}
# Prueba de normalidad para la variable 'bwt' por grupo de fumar


```

```{r normality2_ejerc1-solution}
# Prueba de normalidad para la variable 'bwt' por grupo de fumar
datos%>% 
  group_by(smoke) %>% 
  summarise(shapiro_p_value = shapiro.test(bwt)$p.value)
```

üéØ **Pruebe su conocimiento**


```{r logicals3, echo = FALSE}
question("Seg√∫n el resultado de la prueba de Shapiro-Wilk, ¬øla variable peso al nacer `bwt` sigue una distribuci√≥n normal en ambos grupos de madres (fumadoras y no fumadoras)?",
         answer("Si, la distribuci√≥n es normal en ambos grupos", correct = TRUE, message = "Correcto, la variable `bwt` sigue una distribuci√≥n normal, dado que no se rechaza la hip√≥tesis nula de normalidad en ambos grupos (p valor>0.05)"),
         answer("No, el peso al nacer sigue otra distribuci√≥n de probabilidad" , message = "Incorrecto, el p valor de la prueba de Shapiro Wilk es mayor al nivel de significancia y por lo tanto, no se rechaza la hip√≥tesis nula de normalidad en ambos grupos"),
         allow_retry = FALSE
)
```

Ahora que conocemos, la distribuci√≥n de los datos, utilice el siguiente chunk (bloque) para escribir el c√≥digo de `R` y continuar ayudando al investigador para responder la pregunta: ¬ødifiere el peso al nacer de los beb√©s de madres que fuman del de los beb√©s de madres que no fuman?


```{r mannwhitney2_ejerc1, exercise=TRUE, exercise.setup="global"}

# Estad√≠sticas descriptivas del peso al nacer de acuerdo al h√°bito de fumar


# Prueba para comparar el peso al nacer de acuerdo al h√°bito de fumar

```

```{r mannwhitney2_ejerc1-solution}

# Estad√≠sticas descriptivas del peso al nacer de acuerdo al h√°bito de fumar
datos%>% 
  group_by(smoke) %>% 
  summarise(media = mean(bwt, na.rm = TRUE),
            ds = sd(bwt, na.rm = TRUE))

# Prueba para comparar el peso al nacer de acuerdo al h√°bito de fumar

t.test(bwt ~ smoke, 
            data = datos, 
            alternative = "two.sided", 
            conf.level = 0.95)

```


üéØ **Pruebe su conocimiento**

```{r logicals4, echo = FALSE}
question("Seg√∫n sus resultados, ¬ødifiere el peso al nacer  de los beb√©s de madres que fuman del de los beb√©s de madres que no fuman?",
         answer("Si, existe suficiente evidencia para rechazar la hip√≥tesis nula con la prueba t Student", correct = TRUE),
         answer("Si, existe suficiente evidencia para rechazar la hip√≥tesis nula con la prueba U de Mann Whitney" , message = "Incorrecto, la prueba U de Mann Whitney no es la adecuada, se debe usar la prueba t Student dado que la variable `bwt` sigue una distribuci√≥n normal"),
            answer("No, no existe suficiente evidencia para rechazar la hip√≥tesis nula con la prueba t Student", message= "La prueba es correcta, pero el p valor es menor a 0.05, por lo tanto se rechaza la hip√≥tesis nula de igualdad de las medias"),
         answer("No, no existe suficiente evidencia para rechazar la hip√≥tesis nula con la U de Mann Whitney" , message = "Incorrecto, la prueba U de Mann Whitney no es la adecuada"),   
         allow_retry = FALSE
)
```

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**:Lo invitamos a socializar sus hallazgos en el foro de la semana respondiendo la siguiente pregunta: ¬øEl peso al nacer de los beb√©s de madres fumadoras es mayor o menor en comparaci√≥n con los de madres no fumadoras?
</div>

## Prueba Chi-Cuadrado

Supongamos que un investigador desea evaluar si existe una asociaci√≥n entre el h√°bito de fumar y el bajo peso al nacer de los beb√©s. Para ello, se plantea la hip√≥tesis nula que no hay asociaci√≥n entre las dos variables, y como hip√≥tesis alternativa que s√≠ hay asociaci√≥n.

Para evaluar esta hip√≥tesis, se puede utilizar la prueba de chi-cuadrado de Pearson, que es adecuada para analizar la relaci√≥n entre dos variables cualitativas. En `R`, la funci√≥n `chisq.test()` permite realizar esta prueba. Esta funci√≥n requiere especificar una tabla de contingencia que muestre la frecuencia de cada combinaci√≥n de categor√≠as de las dos variables. 

```{r chi1, exercise=TRUE, exercise.setup="global"}

# Tabla de contingencia para las variables 'smoke' y 'low'

tabla_contingencia <- table(datos$smoke, datos$low)

# Prueba de chi-cuadrado de Pearson

# Test de Chi-cuadrado
result_chisq<-chisq.test(tabla_contingencia)

# Resultado del test
result_chisq

# Frecuencias esperadas

result_chisq$expected

```

Con base en estos resultados, podemos concluir que  s√≠ existe suficiente evidencia para rechazar la hip√≥tesis nula de que no hay asociaci√≥n entre el h√°bito de fumar y el bajo peso al nacer, dado que el p-valor es menor a 0.05. Adicionalmente, dado que las frecuencias esperadas son mayores a 5, se cumplen los supuestos de la prueba de chi-cuadrado. 

```{r chi2, exercise=TRUE, exercise.setup="global"}
datos %>%
  group_by(smoke) %>%
  summarise(
    total = n(),
    bajo_peso = sum(low == "Bajo Peso"),
    porcentaje_bajo_peso = round(100 * bajo_peso / total, 1)
  )
```


Profundizando en los datos, observamos que el 40.5% de los beb√©s de madres fumadoras tienen bajo peso al nacer, mientras que  el 25.2% de los beb√©s de madres no fumadoras presentan esta condici√≥n, siendo esta diferencia estad√≠sticamente significativa de acuerdo a los resultados de la prueba Chi-cuadrado. Esto sugiere que el h√°bito de fumar podr√≠a estar asociado con un mayor riesgo de bajo peso al nacer.

### üß† Desaf√≠o 1

Ahora, el investigador desea evaluar si existe una asociaci√≥n entre la raza de la madre y el bajo peso al nacer. Para ello, se plantea la hip√≥tesis nula que no hay asociaci√≥n entre las dos variables, y como hip√≥tesis alternativa que s√≠ hay asociaci√≥n.

Para evaluar esta hip√≥tesis, utilice el siguiente chunk (bloque) para escribir el c√≥digo de `R` y continuar ayudando al investigador.

```{r chi1_ejerc1, exercise=TRUE, exercise.setup="global"}
# Tabla de contingencia para las variables 'smoke' y 'low'


# Prueba de chi-cuadrado de Pearson

# Test de Chi-cuadrado

# Resultado del test

# Frecuencias esperadas


```


```{r chi1_ejerc1-solution}

# Tabla de contingencia para las variables 'smoke' y 'low'

tabla_contingencia <- table(datos$race, datos$low)

# Prueba de chi-cuadrado de Pearson

# Test de Chi-cuadrado
result_chisq<-chisq.test(tabla_contingencia)

# Resultado del test
result_chisq

# Frecuencias esperadas

result_chisq$expected

```

üéØ **Pruebe su conocimiento**

```{r logicals5, echo = FALSE}
question("Con base en los resultados anteriores, ¬øExiste relaci√≥n entre el bajo peso al nacer y la raza de la madre?",
         answer("No,  existe suficiente evidencia para no rechazar la hip√≥tesis nula a un nivel de significancia de 0.05 y por lo tanto, el % de bajo peso al nacer no cambia significativamente de acuerdo a la raza de la madre", correct = TRUE),
         answer("Si,  existe suficiente evidencia para  rechazar la hip√≥tesis nula a un nivel de significancia de 0.05 y por lo tanto, el % de bajo peso al nacer  cambia significativamente de acuerdo a la raza de la madre"),
         allow_retry = FALSE
)
```

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**:Lo invitamos a socializar sus hallazgos en el foro de la semana respondiendo la siguiente pregunta: ¬øEl porcentaje de bajo peso al nacer de los beb√©s cambia de acuerdo a la raza de la madre?
</div>

## Prueba de McNemar

Un grupo de 100 pacientes hipertensos fue evaluado antes y despu√©s de una intervenci√≥n educativa sobre h√°bitos saludables y la importancia de ser adherente al tratamiento. Se quiere saber si la proporci√≥n de pacientes que toman su medicaci√≥n regularmente cambi√≥ antes y despu√©s de la intervenci√≥n. 

Para ello, se plantea la hip√≥tesis nula que no hay cambio en la proporci√≥n de pacientes que toman su medicaci√≥n regularmente antes y despu√©s de la intervenci√≥n y, como hip√≥tesis alternativa que s√≠ hay un cambio. En este caso, dado que se trata de una muestra pareada, se utilizar√° la prueba de McNemar, que es adecuada para comparar proporciones en muestras relacionadas.

En `R` esto es posible realizarlo con la funci√≥n `mcnemar.test()`, que requiere una tabla de contingencia que muestre las frecuencias de cada combinaci√≥n de categor√≠as de las dos variables. 

```{r mcnemar1, exercise=TRUE, exercise.setup="global"}

# Tabla de contigencia

tabla <- matrix(c(40, 30, 10, 20), nrow = 2,
                dimnames = list(
                  "Antes" = c("S√≠", "No"),
                  "Despu√©s" = c("S√≠", "No"))
)

# Ver tabla
print(tabla)

# Prueba de McNemar
mcnemar.test(tabla)

```

Con base en estos resultados, es posible concluir que la intervenci√≥n educativa tuvo un efecto significativo en la proporci√≥n de pacientes que toman su medicaci√≥n regularmente, dado que el p-valor es menor a 0.05 ($p-value=0.0027$). Esto sugiere que la intervenci√≥n logr√≥ aumentar la adherencia a la medicaci√≥n entre los pacientes hipertensos pasando de 50% al 70%.


### üß† Desaf√≠o 1

Un investigador desea evaluar la efectividad de un nuevo tratamiento para el insomnio. A 80 pacientes se les aplic√≥ un tratamiento durante 4 semanas. Se registr√≥ si presentaban insomnio antes y despu√©s del tratamiento. Los datos se presentan en el siguiente chunk (bloque) en el objeto `tabla2`.

Utilice el siguiente chunk (bloque) para escribir el c√≥digo de `R` y continuar ayudando al investigador. ¬øExiste evidencia para pensar que el tratamiento es efectivo?


```{r mcnemar1_ejerc1, exercise=TRUE, exercise.setup="global"}

# Tabla de contigencia

tabla2 <- matrix(c(30, 20, 5, 25), nrow = 2,
                dimnames = list(
                  "Antes" = c("S√≠", "No"),
                  "Despu√©s" = c("S√≠", "No"))
)

# Ver tabla


# Prueba de McNemar


```



```{r mcnemar1_ejerc1-solution}

# Tabla de contigencia

tabla2 <- matrix(c(30, 20, 5, 25), nrow = 2,
                dimnames = list(
                  "Antes" = c("S√≠", "No"),
                  "Despu√©s" = c("S√≠", "No"))
)

# Ver tabla
print(tabla2)

# Prueba de McNemar
mcnemar.test(tabla2)

```

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**:Lo invitamos a socializar sus hallazgos en el foro de la semana respondiendo la siguiente pregunta: ¬øExiste evidencia para pensar que el tratamiento en contra del insomnio es efectivo?
</div>