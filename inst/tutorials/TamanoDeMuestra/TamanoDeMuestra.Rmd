---
title: "M√≥dulo 3: Tama√±o de la muestra en R"
author: "Erika J. Cantor"
date: "Julio, 2025"
output:
  learnr::tutorial:
    progressive: false
    allow_skip: true
    df_print: default
runtime: shiny_prerendered
description: >
  Tutorial para el c√°lculo del tama√±o de la muestra en R.
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include=FALSE}
# Attach packages:

library(learnr)
library(fontawesome)
library(ggplot2)
library(tidyverse)
library(epiR)
library(pwr)

# Global code chunk settings:
knitr::opts_chunk$set(tutorial.exercise.setup = "global")

```



```{r banner, echo=FALSE, results='asis'}
htmltools::HTML("
  <div style='
    text-align: center;
    margin-bottom: 20px;
  '>
    <img src='images/banner_central.png' style='
      max-width: 100%;
      height: auto;
    '>
  </div>
")
```
 
```{r, echo=FALSE, results='asis'}
htmltools::tags$style(HTML("
  h1 {
    color: #1e90ff; /* Azul para t√≠tulos principales */
  }

  h2 {
    color: #007bff; /* Azul brillante para subt√≠tulos */
  }

  h3 {
    color: #0056b3; /* Azul m√°s oscuro para subt√≠tulos m√°s peque√±os */
  }
"))
```


## Introducci√≥n



```{r, echo=FALSE, out.width="100%", fig.align = "center"}
knitr::include_graphics("images/banner1d.png")  
```


<div class="alert alert-info" role="alert">
Este tutorial interactivo le permitir√° aplicar los conceptos aprendidos sobre los aspectos relevantes involucrados en el  <strong>tama√±o de la muestra </strong> mediante la ejecuci√≥n de c√≥digo en `R`. A trav√©s de ejemplos guiados y ejercicios pr√°cticos, usted desarrollar√° habilidades para elegir y aplicar la f√≥rmula adecuada de acuerdo con los requerimientos y objetivos de una investigaci√≥n con el fin de tomar decisiones informadas.
</div>

### ¬øQu√© aprender√° en esta actividad?

Durante el tutorial, usted aplicar√° los siguientes conceptos:  

- Identificaci√≥n de los elementos necesarios para el c√°lculo del tama√±o muestral.

- Determinaci√≥n del nivel de confianza.

- Error Tipo II/Poder.

- Diferencia m√≠nima significativa.  


<h3>Cr√©ditos</h3>

<p><strong>Autor:</strong> Erika J. Cantor</p>
<p><strong>Afiliaci√≥n:</strong> Departamento de Epidemiolog√≠a Cl√≠nica y Bioestad√≠stica, Facultad de Medicina. Pontificia Universidad Javeriana</p>
<p><strong>Contacto:</strong> <a href="mailto:erika.cantor@javeriana.edu.co">erika.cantor@javeriana.edu.co</a></p>

<p>Este tutorial ha sido desarrollado como parte del curso de <em>Introducci√≥n a la Bioestad√≠stica en la Maestr√≠a en Epidemiolog√≠a Cl√≠nica</em>.</p>



<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Licencia de Creative Commons" style="border-width:0"/></a><br />Esta obra est√° licenciada bajo
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">licencia
de Creative Commons Reconocimiento-NoComercial-CompartirIgual 4.0
Internacional</a>.

##  ¬øC√≥mo desarrollar este tutorial?

A lo largo del tutorial, encontrar√° ejemplos de c√≥digo, ejercicios de programaci√≥n y preguntas de an√°lisis. Los ejemplos de c√≥digo y los ejercicios pretenden introducir habilidades b√°sicas de `R`. No es
necesario tener conocimientos previos sobre R para el desarrollo de este tutorial.

#### `r fa("lightbulb", fill = "orange",  height="2em", width="2em")` = Ejemplo de c√≥digo

Este icono identifica ejemplos de c√≥digo listos para usar. Es posible explorar, ejecutar y modificar este c√≥digo para comprender el funcionamiento de cada funci√≥n o comando. Para ejecutar el c√≥digo, solo es necesario presionar el bot√≥n **Run code** en la esquina superior derecha.


```{r, echo=FALSE, out.width="100%", fig.align = "center"}
knitr::include_graphics("images/ejemplo.png")  
```

> **No es necesario preocuparse por ‚Äúda√±ar‚Äù el c√≥digo:** si se realizan modificaciones que generan errores, el ejemplo original puede restaurarse en cualquier momento mediante el bot√≥n **Start Over** en la esquina superior izquierda.


#### `r fa("pencil-alt", fill = "green", height="2em", width="2em")` = Ejercicio de c√≥digo

Los ejercicios est√°n dise√±ados para aplicar lo aprendido, escribiendo el c√≥digo necesario para resolver las preguntas o problemas planteados.

> **Si siente que se ha quedado sin ideas o no sabe c√≥mo continuar con el ejercicio:** puede consultar el bot√≥n **Solution** (soluci√≥n) o **Hint** (pista) para recibir orientaci√≥n sin perder la oportunidad de aprender activamente.

```{r, echo=FALSE, out.width="100%", fig.align = "center"}
knitr::include_graphics("images/ejercicio.png")  
```

#### `r fa("comments", fill = "#2c5697", height="2em", width="2em")` = Preguntas de an√°lisis

Estas preguntas invitan a reflexionar sobre los resultados y conceptos. Algunas no poseen una √∫nica respuesta correcta, sino que buscan fomentar el pensamiento cr√≠tico. Con frecuencia, estas preguntas est√°n vinculadas con un ejemplo o ejercicio de c√≥digo, y pueden requerir la ejecuci√≥n de dicho c√≥digo para obtener la informaci√≥n necesaria para responderlas.

## Calcular el tama√±o de la muestra con `epiR` y `pwr`

Las funciones utilizadas en este tutorial utilizan las f√≥rmulas presentadas en el    <a rel="link" href="https://research.ebsco.com/c/lckhto/search/details/5k52mkdckf?limiters=FT1%3AY&q=epidemiolog%C3%ADa%20cl%C3%ADnica" target="_blank">Capitulo 6: C√°lculo del tama√±o de la muestra del libro "Epidemiolog√≠a Cl√≠nica: Investigaci√≥n Cl√≠nica Aplicada"</a> de la Universidad Javeriana.  Durante este tutorial utilizaremos las funciones implementadas en el paquete <a rel="link" href="https://cran.r-project.org/web/packages/epiR/epiR.pdf" target="_blank">epiR</a> y <a rel="link" href="https://cran.r-project.org/web/packages/pwr/pwr.pdf" target="_blank">prw</a>. Estos paquetes son ampliamente utilizados en epidemiolog√≠a y bioestad√≠stica, y ofrecen diversas funciones para determinar el tama√±o de la muestra  ya sea para estimar una media, una proporci√≥n, una diferencia de medias entre grupos o una diferencia de proporciones. Adicionalmente, tambi√©n permiten realizar el c√°lculo de acuerdo al dise√±o del estudio (cohortes o casos y controles). 

Las funciones que utilizaremos en el presente tutorial son:


- `epiR::epi.sssimpleestb()`: Tama√±o de la muestra para estimar una proporci√≥n.

- `pwr::pwr.2p.test()`: Tama√±o muestral para comparar dos propociones.

- `epiR::epi.sssimpleestc()`: Tama√±o muestral para estimar una media poblacional.

- `pwr:: pwr.t.test()`: Tama√±o muestral para comparar dos medias.

- `epiR::epi.sscohortc()`: Tama√±o muestral para estudios de cohortes.

- `epiR::epi.sscc()`: Tama√±o muestral para estudios de casos y controles.

Recuerde que usted puede utilizar estas funciones cargando el paquete `epiR` con el comando `library(epiR)` y el paquete `pwr` con el comando `library(pwr)`. No es necesario instalar ning√∫n paquete adicional para este tutorial.


## Tama√±o de muestra para una proporci√≥n


<div style="background-color: #f0f0f0; padding: 15px; border-radius: 5px;">
Un equipo de investigadores desea estimar la prevalencia de hipertensi√≥n arterial en adultos mayores de 65 a√±os que asisten a un hospital de Bogot√°. Estudios previos sugieren que la prevalencia est√° alrededor del 40%. Desean que la estimaci√≥n tenga un margen de error del 5% y un nivel de confianza del 95%.
</div>

### üéØ ¬°Analicemos el enunciado!

En este caso, el equipo de investigadores quiere calcular el tama√±o de la muestra necesario para estimar una proporci√≥n, dado que el objetivo es poder estimar la prevalencia de hipertensi√≥n arterial en adultos mayores de 65 a√±os en un s√≥lo hospital de B√≥got√° y es el √∫nico param√©tro de inter√©s.

C√≥mo se mencion√≥ en las lecturas de la actividad 1, el c√°lculo de la muestra para una proporci√≥n require especificar previamente los siguientes factores de la f√≥rmula:

- Proporci√≥n esperada (p): En este caso, la proporci√≥n esperada es del 40% (0.40). En la vida real, esta informaci√≥n es posible obtenerla a partir de estudios previos o de la literatura cient√≠fica.

- Nivel de confianza ($Z_{\alpha}$): Para un nivel de confianza del 95%, el valor de Z es 1.96. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obetener por medio de la funci√≥n `qnorm(1-alfa/2)`.

- Precisi√≥n buscada o error de estimaci√≥n ($\epsilon$): En este caso, el equipo de investigadores desea un margen de error del 5% (0.05), es decir, ellos quieren que la estimaci√≥n de la prevalencia de hipertensi√≥n arterial no se aleje m√°s del 5% del valor real.

Ahora, estamos listos para indicarle a `R` c√≥mo calcular el tama√±o de la muestra. Para ello, utilizaremos la funci√≥n `epi.sssimpleestb()` del paquete `epiR`. Esta funci√≥n requiere que le indiquemos los valores de los par√°metros mencionados anteriormente. A continuaci√≥n, se muestra un ejemplo de c√≥mo utilizar esta funci√≥n con los datos del problema anterior:

```{r ssprop1, exercise=TRUE}
# Calcular el tama√±o de la muestra para una proporci√≥n
epiR::epi.sssimpleestb(
  N = NA,                   # Tama√±o de la poblaci√≥n (opcional)
  Py = 0.40,                # Proporci√≥n esperada (Requerido)
  epsilon = 0.05,           # Precisi√≥n buscada (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  se = 1,                   # Valor por defecto (No cambiar)
  sp = 1,                   # Valor por defecto (No cambiar)
  error= "absolute"         # Valor por defecto (No cambiar)
)

```

Aqu√≠ los argumentos  `se` y `sp` son fijados en 1 asumiendo que la prueba utilizada para detectar los casos tiene una sensibilidad y especificidad del 100%. El argumento `N` se utiliza para especificar el tama√±o de la poblaci√≥n, pero si no se conoce o no es relevante, se puede dejar como `NA`.

<div style="background-color: #d4f7c5; padding: 15px; border-radius: 5px; color: #1e3d00;">
En este caso entonces, se requieren **369** sujetos para estimar la prevalencia de hipertensi√≥n arterial en adultos mayores de 65 a√±os con un margen de error del 5% y un nivel de confianza del 95%.
</div>

### üß† Desaf√≠o 1

<div class="alert alert-warning" role="alert">
  <strong>¬°Atenci√≥n!</strong> Una investigadora quiere estimar la prevalencia de infecci√≥n por VIH en embarazadas que asisten a controles prenatales en una red hospitalaria regional. Se sabe que la prevalencia estimada en esta poblaci√≥n es 1.5%. Se desea estimarla con una precisi√≥n de ¬±0.5% y un nivel de confianza del 95%. La poblaci√≥n total de embarazadas que asisten en un a√±o es de 4.500.

‚úçÔ∏è Es su turno! Emplee los siguientes chunk (bloque) para escribir el c√≥digo de `R` y ayudar a la investigadora.

```{r ssprop1-ejerc1, exercise=TRUE}


```


```{r ssprop1-ejerc1-solution}
# Calcular el tama√±o de la muestra para una proporci√≥n

epiR::epi.sssimpleestb(
  N = 4500,                 # Tama√±o de la poblaci√≥n (opcional)
  Py = 0.015,               # Proporci√≥n esperada (Requerido)
  epsilon = 0.005,          # Precisi√≥n buscada (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  se = 1,                   # Valor por defecto (No cambiar)
  sp = 1,                   # Valor por defecto (No cambiar)
  error= "absolute"         # Valor por defecto (No cambiar)
)
```
</div>

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**: Lo invitamos a socializar sus hallazgos en el foro de la semana.
</div>


## Tama√±o de muestra para comparar dos proporciones


<div style="background-color: #f0f0f0; padding: 15px; border-radius: 5px;">
Un grupo de investigadores dise√±a un ensayo cl√≠nico aleatorizado para evaluar la eficacia de una nueva vacuna contra la influenza en adultos mayores de 65 a√±os. En estudios anteriores, la incidencia de influenza en adultos sin vacuna fue de 12%. Se espera que la nueva vacuna reduzca esta proporci√≥n al 6%. El ensayo tendr√° una asignaci√≥n 1:1 (la misma cantidad de sujetos en grupo intervenci√≥n y control). Se desea un poder estad√≠stico del 90% y un nivel de confianza del 95% para detectar esa diferencia entre grupos.
</div>

### üéØ ¬°Analicemos el enunciado!

En este caso, el equipo de investigadores quiere calcular el tama√±o de la muestra necesario para la diferencia de proporciones, es decir, se desea conocer el n√∫mero de sujetos necesarios para detectar una diferencia entre la proporci√≥n (que corresponde a la incidencia en este caso) de influenza entre aquellos que reciben la vacuna ($p_1$) y los que no ($p_2$).  Para esto, se requiere identificar los siguientes factores de la f√≥rmula:

- Proporci√≥n esperada en el grupo de intervenci√≥n ($p_1$): En este caso, la proporci√≥n esperada es del 6% (0.06). Este valor corresponde a la proporci√≥n de incidencia de influenza en adultos mayores que reciben la nueva vacuna.

- Proporci√≥n esperada en el grupo de control ($p_2$): En este caso, la proporci√≥n esperada es del 12% (0.12). Este valor corresponde a la proporci√≥n de incidencia de influenza en adultos mayores que no reciben la nueva vacuna.

- Error tipo I ($Z_{\alpha}$): Para un nivel de confianza del 95%, el valor de Z es 1.96. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obetener por medio de la funci√≥n `qnorm(1-alfa/2)`.  Aqu√≠ tambien es importante tener presente la direccionalidad de la prueba, es decir, si se trata de una prueba bilateral o unilateral. En este caso, como se trata de un ensayo clinico se debe realizar de forma bilateral para que el estudio sea capaz de detectar si hay una diferencia en cualquier direcci√≥n entre los grupos, es decir, determinar si la vacuna es **mejor** o **peor **que el control.

- Poder ($Z_{1-\beta}$): En este caso, el poder estad√≠stico deseado es del 90%, lo que significa que se desea tener un 90% de probabilidad de detectar una diferencia si realmente existe. El valor de Z correspondiente a un poder del 90% es 1.28. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obtener por medio de la funci√≥n `qnorm(1-beta)`.

Ahora, estamos listos para indicarle a `R` c√≥mo calcular el tama√±o de la muestra. Para ello, utilizaremos la funci√≥n `pwr.2p.test()` del paquete `pwr`, la cual reporta el n√∫mero requerido por grupo. Esta funci√≥n requiere que le indiquemos los valores de los par√°metros mencionados anteriormente. A continuaci√≥n, se muestra un ejemplo de c√≥mo utilizar esta funci√≥n con los datos del problema anterior:

```{r sspropdif1, exercise=TRUE}
# Calcular el tama√±o de la muestra para la diferencia de proporciones
pwr:: pwr.2p.test(
  h = ES.h(p1 = 0.06,       # Proporci√≥n esperada (p1) (Requerido)
  p2 = 0.12),               # Proporci√≥n esperada (p2) (Requerido)
  sig.level = 0.05,         # Nivel de alfa (Requerido)
  power = .90,              # Poder estad√≠stico (Requerido)
  alternative="two.sided"   # Direccionalidad ("two.sided" (default), "greater" or "less")
  )
```


<div style="background-color: #d4f7c5; padding: 15px; border-radius: 5px; color: #1e3d00;">
En este caso entonces, se requieren **465** sujetos en cada grupo.
</div>


### üß† Desaf√≠o 1

<div class="alert alert-warning" role="alert">
  <strong>¬°Atenci√≥n!</strong> Una direcci√≥n regional de salud desea investigar si existe una diferencia significativa en el uso regular de protector solar entre personas que residen en zonas urbanas y zonas rurales. Estudios previos indican que aproximadamente el 65% de las personas en zonas urbanas usan protector solar regularmente, mientras que esta proporci√≥n es del 50% en zonas rurales. El objetivo del estudio es demostrar que la proporci√≥n de uso en zonas urbanas es mayor que en zonas rurales por medio de un estudio observacional transversal, utilizando los siguientes criterios:

- Nivel de confianza: 95%

- Poder estad√≠stico: 80%
  
**¬øCu√°l es el n√∫mero m√≠nimo de sujetos en cada grupo?**

‚úçÔ∏è Es su turno! Emplee los siguientes chunk (bloque) para escribir el c√≥digo de `R` y ayudar a la direcci√≥n regional.

```{r sspropdif1-ejerc1, exercise=TRUE}


```


```{r sspropdif1-ejerc1-solution}
library(epiR)
# Calcular el tama√±o de la muestra para la diferencia de proporciones
pwr:: pwr.2p.test(
  h = ES.h(p1 = 0.65,       # Proporci√≥n esperada (p1) (Requerido)
  p2 = 0.50),               # Proporci√≥n esperada (p2) (Requerido)
  sig.level = 0.05,         # Nivel de alfa (Requerido)
  power = .80,              # Poder estad√≠stico (Requerido)
  alternative="greater"     # Direccionalidad ("two.sided" (default), "greater" or "less")
  )
```
</div>

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**: Lo invitamos a socializar sus hallazgos en el foro de la semana.
</div>


## Tama√±o de muestra para una media


<div style="background-color: #f0f0f0; padding: 15px; border-radius: 5px;">
En una ciudad con altos niveles de contaminaci√≥n del aire, las autoridades sanitarias desean evaluar el impacto de la exposici√≥n prolongada al material particulado fino (PM2.5) en la funci√≥n pulmonar de la poblaci√≥n adulta. Para ello, se busca estimar la media del volumen espiratorio forzado en un segundo (VEF1) en adultos mayores entre 35 y 70 a√±os que residen en zonas de alta contaminaci√≥n.

Como parte del equipo t√©cnico, usted debe determinar el tama√±o de muestra necesario para estimar la media del VEF1 con un nivel de confianza del 95% y un margen de error m√°ximo aceptable de 100 ml. Un reporte del Estudio Epidemiol√≥gico Prospectivo Urbano y Rural PURE global report√≥ una desviaci√≥n est√°ndar aproximada de 705 ml.
</div>


### üéØ ¬°Analicemos el enunciado!

En este caso, el equipo de investigadores quiere calcular el tama√±o de la muestra necesario para estimar una media, es decir, se desea conocer el n√∫mero de sujetos necesarios para estimar la media del VEF1 en adultos mayores entre 35 y 70 a√±os que residen en zonas de alta contaminaci√≥n. Para esto, se requiere identificar los siguientes factores de la f√≥rmula:

- Desviaci√≥n est√°ndar ($\sigma$): En este caso, la desviaci√≥n est√°ndar es de 705 ml. Este valor se obtiene a partir de estudios previos o de la literatura cient√≠fica.

- Precisi√≥n buscada o Error de estimaci√≥n ($\epsilon$): En este caso, el equipo de investigadores desea un margen de error m√°ximo aceptable de 100 ml. Este valor se obtiene a partir de los objetivos del estudio.

- Nivel de confianza ($Z_{\alpha}$): Para un nivel de confianza del 95%, el valor de Z es 1.96. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obetener por medio de la funci√≥n `qnorm(1-alfa/2)`.

Ahora, estamos listos para indicarle a `R` c√≥mo calcular el tama√±o de la muestra. Para ello, utilizaremos la funci√≥n `epi.sssimpleestc()` del paquete `epiR`. Esta funci√≥n requiere que le indiquemos los valores de los par√°metros mencionados anteriormente. Adicionalmente, para que la funci√≥n pueda calcular el tama√±o de la muestra, es necesario indicar cu√°l ser√≠a el valor esperado de la media a estimar por medio del argumento `xbar`, sin embargo, este valor no debe ser exacto dado que no ser√° utilizado para calcular el tama√±o de la muestra.

A continuaci√≥n, se muestra un ejemplo de c√≥mo utilizar esta funci√≥n con los datos del problema anterior:

```{r ssmean1, exercise=TRUE}
# Calcular el tama√±o de la muestra para una media
epiR::epi.sssimpleestc(
  N = NA,                   # Tama√±o de la poblaci√≥n  (opcional)
  xbar = 2000,              # Media esperada (Requerido)
  sigma = 705,              # Desviaci√≥n est√°ndar (Requerido)
  epsilon = 100,            # Precisi√≥n buscada (Requerido)
  error = "absolute",       # Tipo de error (No modificar)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  )

```

<div style="background-color: #d4f7c5; padding: 15px; border-radius: 5px; color: #1e3d00;">
En este caso se requiere incluir **191** sujetos entre los 35 y 70 a√±os para estimar la media de FEV1.
</div>


### üß† Desaf√≠o 1

<div class="alert alert-warning" role="alert">
  <strong>¬°Atenci√≥n!</strong> Un hospital de la ciudad de Bogot√° desea conocer cu√°l es la calidad de vida de pacientes con artritis reumatoide mayores de 45 a√±os. Para ello, se propone estimar la media del puntaje de calidad de vida utilizando una escala visual analoga (EVA) en una escala de 0 (peor salud imaginable) a 100 (la mejor salud posible). En un estudio previo en poblaci√≥n Colombiana, se report√≥ que la desviaci√≥n est√°ndar del puntaje es de 9.2 puntos. El hospital desea que la estimaci√≥n tenga un margen de error m√°ximo de 1.5 puntos y un nivel de confianza del 99%.

‚úçÔ∏è Es su turno! Emplee los siguientes chunk (bloque) para escribir el c√≥digo de `R` y ayudar al hospital.

```{r ssmean1-ejerc1, exercise=TRUE}


```


```{r ssmean1-ejerc1-solution}
# Calcular el tama√±o de la muestra para una media
epiR::epi.sssimpleestc(
  N = NA,                   # Tama√±o de la poblaci√≥n  (opcional)
  xbar = 85,              # Media esperada (Requerido)
  sigma = 9.2,              # Desviaci√≥n est√°ndar (Requerido)
  epsilon = 1.5,            # Precisi√≥n buscada (Requerido)
  error = "absolute",       # Tipo de error (No modificar)
  conf.level = 0.99,        # Nivel de confianza (Requerido)
  )
```
</div>

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**: Lo invitamos a socializar sus hallazgos en el foro de la semana.
</div>

## Tama√±o de muestra para comparar dos medias

<div style="background-color: #f0f0f0; padding: 15px; border-radius: 5px;">
En un estudio cl√≠nico se desea comparar la eficacia de dos medicamentos antihipertensivos: amlodipino y nifedipino-GITS, en la reducci√≥n de la presi√≥n arterial sist√≥lica matutina (medida entre las 05:00 y las 08:00 h) despu√©s de 8 semanas de tratamiento. Estudios previos han reportado que la desviaci√≥n est√°ndar de la presi√≥n sist√≥lica matutina en pacientes hipertensos es de aproximadamente 12 mmHg. Se espera que la diferencia media en la reducci√≥n de presi√≥n sist√≥lica entre ambos medicamentos sea de 4 mmHg, a favor de amlodipino. Con un nivel de significancia 0.05 y una potencia estad√≠stica del 90%, ¬øCu√° es el el tama√±o de muestra necesario por grupo para detectar esta diferencia esperada en la presi√≥n arterial entre los dos tratamientos? 
</div>


### üéØ ¬°Analicemos el enunciado!

En este caso, el equipo de investigadores quiere calcular el tama√±o de la muestra necesario para la diferencia de medias, es decir, se desea conocer el n√∫mero de sujetos necesarios para detectar una diferencia entre la media de la presi√≥n arterial sist√≥lica matutina en pacientes hipertensos que reciben amlodipino ($\mu_1$) y nifedipino-GITS ($\mu_2$). Para esto, se requiere identificar los siguientes factores de la f√≥rmula:

- Diferencia esperada entre las medias ($\mu_1 - \mu_2$): En este caso, la diferencia esperada es de 4 mmHg. Este valor se obtiene a partir de estudios previos o de la literatura cient√≠fica. No obstante, es importante tener en cuenta que este valor debe ser cl√≠nicamente relevante, es decir, debe ser una diferencia que tenga un impacto significativo en la salud de los pacientes o en el contexto de estudio.

- Desviaci√≥n est√°ndar ($sd$): En este caso, la desviaci√≥n est√°ndar de la variable de resultado es de 12 mmHg. Este valor se obtiene a partir de estudios previos o de la literatura cient√≠fica. 

- Error tipo I ($Z_{\alpha}$): Para un nivel de confianza del 95%, el valor de Z es 1.96. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obetener por medio de la funci√≥n `qnorm(1-alfa/2)`. Este valor depende de la direccionalidad de la hipotesis, es decir, si se trata de una prueba bilateral o unilateral. En este caso, como se trata de un ensayo clinico se debe realizar de forma bilateral para que el estudio sea capaz de detectar si hay una diferencia en cualquier direcci√≥n entre los grupos, es decir, determinar si el amlodipino es **mejor** o **peor** que el nifedipino-GITS.

- Poder ($Z_{1-\beta}$): En este caso, el poder estad√≠stico deseado es del 90%, lo que significa que se desea tener un 90% de probabilidad de detectar una diferencia si realmente existe. El valor de Z correspondiente a un poder del 90% es 1.28. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obtener por medio de la funci√≥n `qnorm(1-beta)`.

Ahora, estamos listos para indicarle a `R` c√≥mo calcular el tama√±o de la muestra. Para ello, utilizaremos la funci√≥n `pwr.t.test()` del paquete `pwr`. Esta funci√≥n requiere que le indiquemos los valores de los par√°metros mencionados anteriormente.  Esta formula basa su c√°lculo utilizando el tama√±o del efecto de Cohen, tambien conocido como **d de Cohen**, que se calcula como la diferencia esperada entre las medias dividida por la desviaci√≥n est√°ndar. La d de Cohen expresa la diferencia entre las medias en t√©rminos de desviaciones est√°ndar. Por ejemplo, una d de Cohen de 0.35 se puede interpretar que la diferencia m√≠nima  deseada entre las medias equivale a  0.35 desviaciones est√°ndar.

A continuaci√≥n, se muestra un ejemplo de c√≥mo utilizar esta funci√≥n con los datos del problema anterior:

```{r ssmeancomp2, exercise=TRUE}

# Valores de los factores de acuerdo con el problema

diff=4                               # Diferencia esperada entre las medias (Requerido)
sd=12                                # Desviaci√≥n est√°ndar (Requerido)
dcohen=abs(diff)/sd                  # C√°lculo del tama√±o del efecto de Cohen (Autom√°tico)

# Calcular el tama√±o de la muestra para la diferencia de medias

pwr:: pwr.t.test(
  d=dcohen,                 # Tama√±o del efecto (No cambiar)
  power=0.90,               # Poder estad√≠stico (Requerido)
  sig.level=0.05,           # Nivel de alfa (Requerido)
  type="two.sample",        # Tipo de prueba (No cambiar)
  alternative="two.sided")  # Direccionalidad ("two.sided", "greater" or "less")
```

<div style="background-color: #d4f7c5; padding: 15px; border-radius: 5px; color: #1e3d00;">
En este caso  se requieren **190** sujetos en cada grupo, es decir, 190 sujetos que reciban amlodipino y 190 sujetos que reciban nifedipino-GITS.
</div>

### üß† Desaf√≠o 1



<div class="alert alert-warning" role="alert">
  <strong>¬°Atenci√≥n!</strong> Un grupo de investigadores desea evaluar la efectividad de una dieta baja en grasas versus una dieta mediterr√°nea en la reducci√≥n de los niveles de colesterol LDL en adultos con dislipidemia leve, despu√©s de 12 semanas de intervenci√≥n. Estudios previos han mostrado que:

En pacientes con dieta baja en grasas, la media de colesterol LDL al final del tratamiento es de 130 mg/dL, con una desviaci√≥n est√°ndar de 15 mg/dL.

Se espera que la dieta mediterr√°nea reduzca el LDL en al menos 10 mg/dL m√°s que la dieta baja en grasas (es decir, hasta 120 mg/dL en promedio). Con esta informaci√≥n, calcule el tama√±o de la muestra necesario para detectar esta diferencia, con una confianza del 95% y un poder del 80%. 

‚úçÔ∏è Es su turno! Emplee los siguientes chunk (bloque) para escribir el c√≥digo de `R` y ayudar al hospital.

```{r ssmeancomp2-ejerc1, exercise=TRUE}



```


```{r ssmeancomp2-ejerc1-solution}
# Valores de los factores de acuerdo con el problema

diff=10                              # Diferencia esperada entre las medias (Requerido)
sd=15                                # Desviaci√≥n est√°ndar (Requerido)
dcohen=abs(diff)/sd                  # C√°lculo del tama√±o del efecto de Cohen (Autom√°tico)

# Calcular el tama√±o de la muestra para la diferencia de medias

pwr:: pwr.t.test(
  d=dcohen,                 # Tama√±o del efecto (No cambiar)
  power=0.80,               # Poder estad√≠stico (Requerido)
  sig.level=0.05,           # Nivel de alfa (Requerido)
  type="two.sample",        # Tipo de prueba (No cambiar)
  alternative="two.sided")  # Direccionalidad ("two.sided", "greater" or "less")
```
</div>

<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**: Lo invitamos a socializar sus hallazgos en el foro de la semana.
</div>


## Tama√±o de muestra para estudios de cohortes

<div style="background-color: #f0f0f0; padding: 15px; border-radius: 5px;">
El consumo de bebidas azucaradas (BAs) se ha asociado con un mayor riesgo de desarrollar diabetes tipo 2 y resistencia a la insulina en diversos estudios realizados en poblaciones de mediana y avanzada edad. Sin embargo, existe poca evidencia sobre el efecto del consumo de BAs en mujeres en edad f√©rtil, especialmente, en relaci√≥n con la diabetes mellitus gestacional (DMG). Por ello, un grupo de investigadores plantea realizar un estudio de cohorte para evaluar si el consumo regular de BAs antes del embarazo se asocia con un mayor riesgo de DMG. El grupo expuesto estar√° conformado por mujeres embarazadas que consumen BAs en una frecuencia igual o superior a 5 porciones por semana (‚â•5 porciones/semana), mientras que el grupo no expuesto incluir√° a aquellas que consumen menos de 1 porci√≥n al mes (<1 porci√≥n/mes).

Con base en evidencia reciente, se estima que la incidencia de DMG en la poblaci√≥n general es de aproximadamente 6,4%. Los investigadores suponen que el consumo frecuente de BAs aumentar√≠a este riesgo en un 22%. El estudio se dise√±ar√° con un nivel de confianza del 95% y una potencia estad√≠stica del 80%. **¬øCu√°l es el tama√±o de muestra necesario en cada grupo para detectar esta diferencia?**
</div>

### üéØ ¬°Analicemos el enunciado!

En este caso, el equipo de investigadores quiere calcular el tama√±o de la muestra necesario para un estudio de cohorte, es decir, se desea conocer el n√∫mero de sujetos necesarios para detectar una diferencia entre la incidencia de DMG en mujeres embarazadas que consumen BAs con frecuencia ($p_{exp1}$) y aquellas que no lo hacen ($p_{exp0}$). Para esto, se requiere identificar los siguientes factores de la f√≥rmula:

- Proporci√≥n esperada en el grupo no expuesto ($p_{exp0}$): En este caso, la proporci√≥n esperada es del 6.4% (0.064). Este valor corresponde a la incidencia de DMG en la poblaci√≥n general.

- Proporci√≥n esperada en el grupo expuesto ($p_{exp1}$): En este caso, la proporci√≥n esperada es del 7.8% (0.078). Aunque no se menciona expl√≠citamente en el enunciado, este valor se calcula como $p_{exp1} = p_{exp0}*(1+ 0.22)$, es decir, se asume que el consumo frecuente de BAs aumenta la incidencia de DMG en un 22%, por lo que el riesgo relativo esperado es de $RR=1.22$. 

- Error tipo I ($Z_{\alpha}$): Para un nivel de confianza del 95%, el valor de Z es 1.96. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obtener por medio de la funci√≥n `qnorm(1-alfa/2)`.

- Poder ($Z_{1-\beta}$): En este caso, el poder estad√≠stico deseado es del 80%, lo que significa que se desea tener un 80% de probabilidad de detectar una diferencia si realmente existe. El valor de Z correspondiente a un poder del 80% es 0.84. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obtener por medio de la funci√≥n `qnorm(1-beta)`.

- Raz√≥n de expuestos y no expuestos ($r$): En este caso,  la raz√≥n de expuestos y no expuestos no fue especificada, pero se asumir√° de 1:1, es decir, se espera que el n√∫mero de mujeres embarazadas que consumen BAs con frecuencia sea igual al n√∫mero de aquellas que no lo hacen.

Ahora, estamos listos para indicarle a `R` c√≥mo calcular el tama√±o de la muestra. Para ello, utilizaremos la funci√≥n `epi.sscohortc()` del paquete `epiR`. Esta funci√≥n requiere que le indiquemos los valores de los par√°metros mencionados anteriormente. A continuaci√≥n, se muestra un ejemplo de c√≥mo utilizar esta funci√≥n con los datos del problema anterior:

```{r sssamplecohort1, exercise=TRUE}
# Calcular el tama√±o de la muestra para un estudio de cohorte
epiR::epi.sscohortc(
  irexp0 = 0.064,           # Proporci√≥n esperada en el grupo no expuesto (Requerido)
  irexp1 = 0.078,           # Proporci√≥n esperada en el grupo expuesto (Requerido)
  r = 1,                    # Raz√≥n de expuestos y no expuestos (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  power = 0.80,             # Poder estad√≠stico (Requerido)
  n= NA,                    # N√∫mero total de sujetos en el estudio (No cambiar)
)
```

El argumento `n` se utiliza para especificar el n√∫mero total de sujetos en el estudio cuando se utiliza esta misma funci√≥n para calcular el poder estad√≠stico. En este caso, no es necesario especificar este argumento, por lo que se debe dejar como `n=NA`para que la funci√≥n `epiR::epi.sscohortc()` calcule el tama√±o de la muestra.

<div style="background-color: #d4f7c5; padding: 15px; border-radius: 5px; color: #1e3d00;">
Un total de **10564** mujeres embarazadas son requeridas para el estudio, de las cuales 5282 deben consumir BAs con frecuencia y 5282 no deben consumir BAs. 
</div>

### üß† Desaf√≠o 1

<div class="alert alert-warning" role="alert">
  <strong>¬°Atenci√≥n!</strong> 
Un grupo de investigadores desea evaluar si los reci√©n nacidos expuestos al VIH pero no infectados (**grupo expuesto**) tienen un mayor riesgo de hospitalizaci√≥n o muerte por causas infecciosas durante los primeros seis meses de vida, en comparaci√≥n con los reci√©n nacidos no expuestos al VIH (**grupo no expuesto**). Para ello, se propone un estudio de cohorte prospectivo en una unidad de atenci√≥n materna comunitaria, donde se incluir√°n madres VIH positivas y negativas, junto con sus reci√©n nacidos.

Definiciones:

- Expuestos: Reci√©n nacidos de madres con VIH, pero no infectados al nacer.

- No expuestos: Reci√©n nacidos de madres VIH negativas.

- Desenlace: Hospitalizaci√≥n por causa infecciosa o muerte antes de los 6 meses de vida.

Seg√∫n estudios anteriores, se estima que la proporci√≥n de hospitalizaci√≥n o muerte por causas infecciosas en ni√±os no expuestos al VIH es de aproximadamente 8%. Los investigadores esperan que esta proporci√≥n aumente a 14% en el grupo expuesto. Se desea dise√±ar el estudio con un nivel de confianza del 95% y una potencia estad√≠stica del 90%.

‚úçÔ∏è Es su turno! Emplee los siguientes chunk (bloque) para escribir el c√≥digo de `R` y ayudar a los investigadores.

```{r sssamplecohort1-ejerc1, exercise=TRUE}



```


```{r sssamplecohort1-ejerc1-solution}
# Calcular el tama√±o de la muestra para un estudio de cohorte
epiR::epi.sscohortc(
  irexp0 = 0.08,            # Proporci√≥n esperada en el grupo no expuesto (Requerido)
  irexp1 = 0.14,            # Proporci√≥n esperada en el grupo expuesto (Requerido)
  r = 1,                    # Raz√≥n de expuestos y no expuestos (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  power = 0.90,             # Poder estad√≠stico (Requerido)
  n= NA,                    # N√∫mero total de sujetos en el estudio (No cambiar)
)
```
</div>



<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**: Lo invitamos a socializar sus hallazgos en el foro de la semana.
</div>




## Tama√±o de muestra para estudios de casos y controles

<div style="background-color: #f0f0f0; padding: 15px; border-radius: 5px;">
Un grupo de investigadores desea identificar cu√°les actividades sociales estuvieron asociadas con un mayor riesgo de infecci√≥n por SARS-CoV-2 en Colombia, para aportar evidencia √∫til en la formulaci√≥n de medidas de prevenci√≥n para futuras pandemias. Para ello, se propone realizar un estudio de casos y controles, los casos estar√°n conformados por personas que fueron diagnosticadas con COVID-19 mediante RT-PCR, mientras que los controles ser√°n personas que no presentaron la infecci√≥n. La informaci√≥n se recoger√° mediante entrevistas telef√≥nicas sobre diversas exposiciones comunitarias ocurridas durante los 14 d√≠as previos a la infecci√≥n, como:

- Asistencia a gimnasios.

- Eventos sociales >20 personas.

- Contacto con personas con diagn√≥stico confirmado de COVID-19


Con base en estudios previos, se sabe que en Colombia el 35% de las personas asisten a gimnasios, el 20% de las personas asisten a eventos sociales con m√°s de 20 personas y el 10% de las personas reportan haber tenido contacto con personas con diagn√≥stico confirmado de COVID-19. Adicionalmente, se espera un OR de 1.8 para la asistencia a gimnasios, 4.9 para eventos sociales y 13.0 para contacto con personas con diagn√≥stico confirmado de COVID-19. ¬øCu√°l es el tama√±o de muestra m√≠nimo requerido por grupo (casos y controles) para este estudio con un nivel de confianza del 95% y un poder estad√≠stico del 80%?
</div>

### üéØ ¬°Analicemos el enunciado!
En este caso, el equipo de investigadores quiere calcular el tama√±o de la muestra necesario para un estudio de casos y controles, es decir, se desea conocer el n√∫mero de sujetos necesarios para detectar una diferencia entre la proporci√≥n de personas que asisten a gimnasios, eventos sociales y contacto con personas con diagn√≥stico confirmado de COVID-19 en los casos y los controles. No obstante, dado que los investigadores desean evaluar simult√°neamente tres exposiciones en un mismo estudio, se requiere realizar el c√°lculo para cada una de las exposiciones por separado y elegir el mayor tama√±o de muestra requerido. Para esto, se requiere identificar los siguientes factores de la f√≥rmula:

- Proporci√≥n esperada de la exposici√≥n en el grupo de controles ($p_{0}$): En este caso, la proporci√≥n esperada es del 35% (0.35) para la asistencia a gimnasios, 20% (0.20) para eventos sociales y 10% (0.10) para contacto con personas con diagn√≥stico confirmado de COVID-19. Estos valores corresponden a la proporci√≥n de personas que reportan estas exposiciones en la poblaci√≥n general.

- Odds Ratio (OR): En este caso contamos con los OR esperados, los cuales son  de 1.8 para la asistencia a gimnasios, 4.9 para eventos sociales y 13.0 para contacto con personas con diagn√≥stico confirmado de COVID-19.  En caso de contar con la proporci√≥n esperada de la exposici√≥n en el grupo de casos ($p_1$), se puede calcular el OR esperado como $OR = (p_1/(1-p_1)) / (p_0/(1-p_0))$.

- Error tipo I ($Z_{\alpha}$): Para un nivel de confianza del 95%, el valor de Z es 1.96. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obtener por medio de la funci√≥n `qnorm(1-alfa/2)`.

- Poder ($Z_{1-\beta}$): En este caso, el poder estad√≠stico deseado es del 80%, lo que significa que se desea tener un 80% de probabilidad de detectar una diferencia si realmente existe. El valor de Z correspondiente a un poder del 80% es 0.84. Este valor se obtiene de la tabla de la distribuci√≥n normal est√°ndar. En `R` se podr√≠a obtener por medio de la funci√≥n `qnorm(1-beta)`.

Ahora, estamos listos para indicarle a `R` c√≥mo calcular el tama√±o de la muestra. Para ello, utilizaremos la funci√≥n `epi.sscc()` del paquete `epiR`. Esta funci√≥n requiere que le indiquemos los valores de los par√°metros mencionados anteriormente. A continuaci√≥n, se muestra un ejemplo de c√≥mo utilizar esta funci√≥n con los datos del problema anterior:

```{r sssamplecc1, exercise=TRUE}
# Calcular el tama√±o de la muestra para un estudio de casos y controles

n_gimnasio<-epiR::epi.sscc(
  OR = 1.8,                 # OR esperado (Requerido)
  p0 = 0.35,                # Proporci√≥n esperada en el grupo de controles (Requerido)
  r = 1,                    # Raz√≥n de casos y controles (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  power = 0.80,             # Poder estad√≠stico (Requerido)
  n= NA,                    # N√∫mero total de sujetos en el estudio (No cambiar)
)

n_eventos<-epiR::epi.sscc(
  OR = 4.9,                 # OR esperado (Requerido)
  p0 = 0.20,                # Proporci√≥n esperada en el grupo de controles (Requerido)
  r = 1,                    # Raz√≥n de casos y controles (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  power = 0.80,             # Poder estad√≠stico (Requerido)
  n= NA,                    # N√∫mero total de sujetos en el estudio (No cambiar)
)

n_contacto<-epiR::epi.sscc(
  OR = 13.0,                # OR esperado (Requerido)
  p0 = 0.10,                # Proporci√≥n esperada en el grupo de controles (Requerido)
  r = 1,                    # Raz√≥n de casos y controles (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  power = 0.80,             # Poder estad√≠stico (Requerido)
  n= NA,                    # N√∫mero total de sujetos en el estudio (No cambiar)
)

print(
  list(
    casos = list(
      gimnasio  = n_gimnasio$n.case,
      eventos   = n_eventos$n.case,
      contacto  = n_contacto$n.case
    ),
    controles = list(
      gimnasio  = n_gimnasio$n.control,
      eventos   = n_eventos$n.control,
      contacto  = n_contacto$n.control
    )
  )
)
```

El argumento `n` se utiliza para especificar el n√∫mero total de sujetos en el estudio cuando se utiliza esta misma funci√≥n para calcular el poder estad√≠stico. En este caso, no es necesario especificar este argumento, por lo que se debe dejar como `n=NA`para que la funci√≥n `epiR::epi.sscc()` calcule el tama√±o de la muestra. 

<div style="background-color: #d4f7c5; padding: 15px; border-radius: 5px; color: #1e3d00;">
Con base en los resultados obtenidos en R, el n√∫mero m√≠nimo de sujetos requerido en cada grupo ‚Äîcasos (personas con COVID-19) y controles (personas no infectadas)‚Äî es de **189**, con el fin de asegurar que el estudio tenga el poder estad√≠stico suficiente para evaluar simult√°neamente las tres exposiciones de inter√©s.
</div>

### üß† Desaf√≠o 1


<div class="alert alert-warning" role="alert">
  <strong>¬°Atenci√≥n!</strong> 
Un grupo de investigadores est√° interesado en identificar factores de riesgo asociados a la mortalidad en pacientes con tuberculosis multirresistente (MDR-TB). Para ello, proponen un estudio de casos y controles anidado dentro de una cohorte nacional de pacientes con diagn√≥stico confirmado de MDR-TB. Los casos se definir√°n como los pacientes que fallecieron por cualquier causa durante el tratamiento para MDR-TB. Por cada caso, se seleccionar√° un control vivo y en tratamiento al momento del fallecimiento del caso. Uno de los factores que se desea evaluar es la presencia de VIH como posible determinante de muerte. Estudios anteriores sugieren que alrededor del 25% de los controles tiene diagn√≥stico positivo para VIH. Los investigadores desean poder detectar una raz√≥n de oportunidades (OR) de al menos 2.0 para esta asociaci√≥n. El estudio se dise√±ar√° con un nivel de confianza del 95% y un poder estad√≠stico del 90%.¬øCu√°ntos casos y controles se requieren como m√≠nimo para detectar esta asociaci√≥n con los par√°metros especificados? ¬øCu√°l ser√≠a el tama√±o de la muestra si el poder  se reduce al 80%?


‚úçÔ∏è Es su turno! Emplee los siguientes chunk (bloque) para escribir el c√≥digo de `R` y ayudar a los investigadores.

```{r sssamplecc1-ejerc1, exercise=TRUE}



```


```{r sssamplecc1-ejerc1-solution}
# Calcular el tama√±o de la muestra para un estudio de casos y controles

# Poder del 90%
epiR::epi.sscc(
  OR = 2.0,                 # OR esperado (Requerido)
  p0 = 0.25,                # Proporci√≥n esperada en el grupo de controles (Requerido)
  r = 1,                    # Raz√≥n de casos y controles (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  power = 0.90,             # Poder estad√≠stico (Requerido)
  n= NA,                    # N√∫mero total de sujetos en el estudio (No cambiar)
)

# Poder del 80%
epiR::epi.sscc(
  OR = 2.0,                 # OR esperado (Requerido)
  p0 = 0.25,                # Proporci√≥n esperada en el grupo de controles (Requerido)
  r = 1,                    # Raz√≥n de casos y controles (Requerido)
  conf.level = 0.95,        # Nivel de confianza (Requerido)
  power = 0.80,             # Poder estad√≠stico (Requerido)
  n= NA,                    # N√∫mero total de sujetos en el estudio (No cambiar)
)

```
</div>




<div class="alert alert-info" role="alert">
üó£Ô∏è **Nota**: Lo invitamos a socializar sus hallazgos en el foro de la semana.
</div>
